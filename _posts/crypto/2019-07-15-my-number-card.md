---
layout:        post
title:         "マイナンバーカードの技術仕様"
date:          2019-07-15
category:      Crypto
author:        tex2e
cover:         /assets/cover4.jpg
redirect_from:
comments:      true
published:     true
---

マイナンバーカードの技術仕様 (ICカード規格、搭載情報、セキュリティ対策) や利活用方法、今後期待される展開などについて説明します。

2016年1月からマイナンバー(個人番号)の利用とマイナンバーカードの交付が開始しました。
マイナンバーは社会保障や税、災害対策の分野で行政の効率化と国民の利便性向上を目的としています。
マイナンバーは国民一人ひとりに与えられた12桁の番号のことです。
特に、**公的個人認証** はPKI (Public Key Infrastructure : 公開鍵基盤) 技術に基づき、インターネット経由でのセキュアな本人認証や電子申請を可能とする点で、今まで押印するところに取って代わる技術なので、様々なシーンでの利用が期待されています[^fujitsu]。

## 技術仕様

マイナンバーカードの技術仕様について説明します。

### 券面

マイナンバーカードの表面には以下の情報が書かれています。

- 氏名、住所、生年月日、性別 (基本4情報)
- 顔写真
- 電子証明書の有効期限
- セキュリティコード

券面の偽造対策については、次のことが施されています[^kita-tokyo] [^nisc]。

- 複雑な**彩紋パターン**が施されています。
- **パールインキ**を利用しているので、光の加減で別の色に見える部分があります。
- コピー時に「複写」の文字が浮かび上がるようになっています。
- **レーザーエングレーブ**という技術を用い、レーザー光でカード基材を黒く変質させることで印字する技術で、偽変造が困難になります。
- 写真は**シェーディング加工**により顔写真のエッジにぼかし加工を施すことで、顔写真の貼り替えが困難になります。
- 特定の箇所に通常のコピー機やプリンターでは印刷できない**マイクロ文字**という微細な文字を配置することにより、偽造が困難になります。

### ICチップ

マイナンバーカードは接触・非接触の両方のインターフェースを持ちます。
いわゆる、コンビネーション型のICカードです。

- 接触インターフェース (カード裏面の黒帯の部分) は **ISO/IEC 7816** 準拠
- 非接触インターフェース (カード内部) は **ISO/IEC 14443 TypeB** 準拠

非接触インターフェースの分類は以下の通りです。

| 分類 | 準拠規格 | 概要 |
|-----|-----|-----|
| TypeA | ISO/IEC 14443 <br> ISO/IEC 18092 | 低機能、小容量の安価なカード。古くから採用されている。<br>例) 入退室専用カード、taspo
| TypeB | ISO/IEC 14443 | 高機能、高セキュリティのカード。PKIに対応したものが多い。<br>例) パスポート、運転免許証、マイナンバーカード
| FeliCa | ISO/IEC 18092 | 低機能、小容量の安価なカード。交通系や電子マネーで採用。<br>例) Suica、楽天Edy、nanaco

ICチップにはカードOSと呼ばれるICチップ専用のOSが搭載されています。
カードOS上では各種カードアプリケーション (以下、カードAP) を動作させることができます。
カードAP内に格納されたデータへのアクセスには暗証番号 (PIN : Personal Identification Number) による認証が必要です。
また、カードは**耐タンパ性**を備えているので、物理的な解析に対しては自動的に内部の情報が削除されるようになっています。
さらに、暗証番号はカードAP毎に異なり、暗証番号の入力を一定回数以上間違えるとカードがロックされます[^soumu-go-jp-card]。

### カードAP

マイナンバーカードには以下の4つのカードAP (カードアプリケーション) が標準搭載されています。
これら以外にも空き領域に各種業務APを搭載することも可能です。

#### (1) 公的個人認証サービスによる電子証明書アプリケーション（JPKI-AP）

JPKI-APは、PKIの電子証明書による電子署名や本人認証を行うためのカードAPです。
搭載される電子証明書には、署名用電子証明書と利用者証明書電子証明書の2種類があります。
これらを利用するときには**暗証番号** (PIN) の入力が必要になります。
署名用電子証明書は6〜16桁の英数字、利用者証明用電子証明書は4桁の数字が暗証番号としてマイナンバーカードの利用者が設定します (暗証番号は、カード受け取り時に役所の職員には見えない形で入力します)。

#### (2) 券面アプリケーション（券面AP）

カードの画像データを保持するカードAPで、基本4情報、顔写真、個人番号の画像を格納していて、券面偽変造の有無を確認できます。
なお、情報の読み出しには4桁の暗証番号によるアクセス制限が施されています。

#### (3) 券面事項入力補助アプリケーション（券面入力補助AP）

個人番号や基本4情報をテキストデータとして保持するカードAPで、これらの情報を各種業務APに入力する場合に利用できます。ただし、個人番号は法令で認められる場合のみ利用できます。
なお、情報の読み出しには4桁の暗証番号によるアクセス制限が施されています。

#### (4) 住基アプリケーション（住基AP）

住民票コードを保持するカードAPで、自治体の利用に制限されます。
なお、情報の読み出しには4桁の暗証番号によるアクセス制限が施されています。

#### APDUコマンドによる通信

ICカードであるマイナンバーカードは、APDUコマンドを使うことで暗証番号を送信してアクセス制限を解除したり、証明書を取得したり、データに対して署名を行ったりします。
この辺りは開発者向けの話なので、[別記事](../protocol/jpki-mynumbercard-with-apdu)で説明しています。


<br>
## マイナンバーカードの利活用

マイナンバーは**社会保障、税金、災害対策**などの法令で定められた業務以外では利用が禁止されています。しかし、マイナンバーカードを公的個人認証として利用する分には問題ありません。
これからマイナンバーカードで法令で定められた用途以外の何かやろうと考えている人は、次の点に注意をする必要があります。

- カメラなどを使用する際はマイナンバーカードの表面のみを撮影します。カードカバーが付いていても、**裏面のQRコードの部分を読み取ると個人番号が取得できてしまう**ので、絶対に裏面を撮影してはいけません。
- 券面事項入力補助APを利用する場合は、個人番号を使わないシステムを作る必要があります (例えば、テーブルの主キーを個人番号にしない、など)。

<div class="tip">
<h4>マイナンバーは法令で定められた用途以外で利用できません</h4>
マイナンバーカードの裏面には、<b>マイナンバー (個人番号)</b> が記載されています。これは、<b>法令で定められた用途以外での利用が禁止</b>されています。例えば、個人番号を社員番号として使うことはできません。本人確認として使う際には、顔写真のある表面のみを使うことになります。これがわざわざ「表面」と強調している理由です。
</div>

### 電子証明書

マイナンバーカードには2種類の電子証明書があり、電子署名と本人認証に利用できます。
**署名用電子証明書**は、電子文書に対して電子署名をすることができ、電子申請が本人から申請されたものであることや改ざんされていないことが確認できます。そのため、押印の代わりになることができます。現在、署名用電子証明書は e-Tax で利用されています。
また、**利用者証明用電子証明書**は、Webサイトへのログインなどで使うことができ、パスワードによるログイン認証に比べてセキュリティの高い本人認証ができるようになります。

電子証明書の検証はサービス事業者が行います。
また、電子証明書の発行、失効は J-LIS (地方公共団体情報システム機構) が管理しています。
企業が公的個人認証を使ったサービスを提供する際には、サービスの中で署名の検証を行い、J-LISが管理する情報を使って証明書の有効性を判断します。

```
 myNumberCard
      : NFC
      V             [client]  userInfo   [server]      query    [J-LIS]
  CardReader --------> PC --------------> system ---------------> DB
                          <--------------        <---------------
                              authorize                CRL
```

### 空き領域の利用

空き領域は「地域住民向け領域」と「拡張利用領域」に分かれています。
独自のカードAPを搭載するときに使います。
地域住民向け領域は各自治体が利用でき、拡張利用領域は国、都道府県、市区町村、民間企業等が利用できます (民間企業が利用する際には、総務大臣への認可申請が必要となります)。
J-LISによると、次のような利用方法を想定しているようです。

- 地域住民向け領域 : 広域交付サービス、図書館サービス、印鑑登録証サービスなど [^j-lis-card-ex1]
- 拡張利用領域 : 公務員身分証、社員証、出退勤、ポイントサービスなど [^j-lis-card-ex2]

<br>
## 今後期待される展開

マイナンバーカードの普及とマイナンバーの利活用の促進に関する方針（案）(2019/6) [^kantei] によると、以下のことが行われることが予想されます。

- 2020年 : マイナンバーカードを活用した自治体ポイントによる消費活性化策
- 2021年3月 : マイナンバーカードの健康保険証利用
- 2021年3月 : マイナポータルにおいて特定健診の情報の閲覧を開始
- 2021年10月 : マイナンバーカードのお薬手帳としての利用
- 2021年10月 : マイナポータルにおいて薬剤情報、医療費情報の閲覧を開始

また、マイナンバーカードと健康保険証の一体化への安全性について、文書[^kantei] によると、医療機関などでは患者さんがICカードリーダと暗証番号の入力を通して、カードのICチップの中の電子証明書を医療機関に渡して本人認証を行うので、マイナンバーと診察情報が紐付くことはない。とのことです。

（ただし、利用者証明用電子証明書の暗証番号と、券面入力補助AP(マイナンバー)の暗証番号を同じにしている場合は、悪意のあるサービスによってマイナンバーと診察情報を紐付けることが可能になりますが...）

今後、政府にはマイナンバーカードを基盤とした安全で利便性の高いデジタル社会と効率的な行政の構築を目指してもらいたいと思っています。

以上です。


#### 参考文献
- [J-LIS 利用者クライアントソフトに係る技術仕様について](https://www.j-lis.go.jp/jpki/procedure/procedure1_2_3.html)
- [雑誌FUJITSU 2017-7月号 マイナンバー - 富士通](https://www.fujitsu.com/jp/about/resources/publications/magazine/backnumber/vol68-4.html)

-----

[^fujitsu]: [マイナンバーカードの技術仕様と利活用方法 --- FUJITSU 2017](https://www.fujitsu.com/jp/documents/about/resources/publications/magazine/backnumber/vol68-4/paper10.pdf)
[^kita-tokyo]: [マイナンバー制度のセキュリティ・情報漏えい対策 --- 東京都北区](https://www.city.kita.tokyo.jp/koseki/mynumber/gaiyou/securityinfo.html)
[^nisc]: [マイナンバー制度について --- 内閣サイバーセキュリティセンター](https://www.nisc.go.jp/conference/cs/ciip/dai04/pdf/04shiryou0203.pdf)
[^j-lis-card-ex1]: [地域住民向け領域の利用について --- J-LIS](https://www.j-lis.go.jp/rdd/card/jyoureiriyou/cms_93097720215.html)
[^j-lis-card-ex2]: [マイナンバーカードアプリケーション搭載システム (拡張利用領域の利用) --- J-LIS](https://www.j-lis.go.jp/rdd/card/bango-ap/cms_bangoap.html)
[^kantei]: [マイナンバーカードの普及とマイナンバーの利活用の促進に関する方針 (案) --- デジタル・ガバメント閣僚会議 (2019/6)](https://www.kantei.go.jp/jp/singi/it2/dgov/dai4/siryou1-2.pdf)
[^soumu-go-jp-card]: [マイナンバー制度とマイナンバーカード --- 総務省](http://www.soumu.go.jp/kojinbango_card/03.html)
