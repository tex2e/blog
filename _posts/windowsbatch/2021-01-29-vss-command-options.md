---
layout:        post
title:         "[Windows] VSSコマンドのオプション一覧"
date:          2021-01-29
category:      WindowsBatch
cover:         /assets/cover14.jpg
redirect_from:
comments:      true
published:     true
latex:         false
photoswipe:    false
# sitemap: false
# feed:    false
---

VSSコマンドのオプション一覧についての備忘録


### `-#` (historyの件数)

ファイルまたはプロジェクトの履歴コマンドで表示するエントリ数を指定します。

- `-#` <br>
ファイルまたはプロジェクトのすべてのエントリを指定します。

- `-#<number>` <br>
ファイルまたはプロジェクトに表示するエントリの数を指定します。


### `-C` (checkoutのコメント)

コメントを指定します。Cオプションを指定しない場合、VSSはコマンドラインで指定された各項目に対してコメントを要求します。オプションを指定した場合、すべての項目に同じコメントが表示されます。

- `-C` <br>
すべての項目で同じコメントを受け取ることを指定します。

- `-C-` <br>
コメントを使用しないように指定します。

- `-C<文字列>` <br>
全ての項目のコメントに指定した文字列を使用します。

- `-C@<ファイル名>` <br>
指定したファイルの内容を全項目のコメントとして使用します。

- `-C?` <br>
VSSの既定値に戻ります。これは、個々のファイルごとにコメントを要求することです。


### `-D` (historyの差分表示方法)

VSSが差分を表示する方法を制御します。このオプションは、速度を向上させ、ディスク容量を節約するためにバイナリファイルで頻繁に使用されます。

- `-D` <br>
差分に使用する表示を定義します。表示は、追加、削除、変更、読みやすさの最適化を行った行のリストを表示します。

- `-D-` <br>
VSSデータベース内のファイルの最新バージョン以外を表示します。

- `-DS<行幅>` <br>
標準スタイルの表示を指定します。既定では、VSSはこの表示を使用し、画面に合うように計算された行幅で、コンテキスト行は表示されません。たとえば、挿入された行は次のように表示されます。
  ```
  27 Ins: hello, world
  ```

- `-DU<行幅>` <br>
UNIX スタイルの表示を指定します。デフォルトでは幅 70 文字、5 行のコンテキスト行を指定します。この表示は、UNIX diff ユーティリティで使用される標準フォーマットと同様の情報を表示します。例えば、以下のようになります。
  ```
  26a27

  > hello, world
  ```
  オプション付きで実行する例：
  ```
  ss History -DU70X5
  ```

- `-DV<行幅>` <br>
ファイル全体を表示するビジュアル表示を指定し、変更点の注釈を付けて表示します。この表示は、ファイルの違いを横に並べて表示します。
  ```
  ss History -DV35
  ```

- `-DX` <br>
各変更の周囲に3行のコンテキストを持つ表示を指定します。

- `-DX-` <br>
変更の周囲にコンテキスト行を持たない表示を指定します。

- `-DX<数値>` <br>
変更の周囲の\<番号>行の表示を指定します。


### `-E` (エンコーディングの指定)

ファイルのチェックアウト情報を含む、Dirコマンドの拡張表示を生成します。Shareコマンドでは、このオプションは、共有ではなく、共有と分岐の操作を指定します。Add、Properties、Filetypeコマンドと一緒に使用する場合、このオプションはファイルのエンコーディングを指定します。

- `-E` <br>
  - Dir コマンドに対してのみファイルを表示します。
    ```
    ss Dir $/web.txt -E
    ```
  - Shareコマンドでは共有と分岐の操作を指定します。
    ```
    ss Share $/web.txt -E
    ```
  - Add、Properties、Filetypeコマンドの場合、-Eはファイルのエンコーディングを指定します。
    ```
    ss Properties $/file.txt -Eutf8
    ```


### `-F`

プロジェクトを含まないファイルのみの表示を有効にします。

- `-F` <br>
ファイルの表示を有効にします。

- `-F-` <br>
ファイルの表示を無効にします。

### `-G` (ファイル取得時)

取得した作業コピーのオプションを設定します。このオプションのスイッチの多くは、Ss.ini ファイルで設定できるコマンド固有のオーバーライドを提供しています。

- `-G` <br>
ローカルバージョンの検索を指定します。
- `-G-` <br>
取得操作を行わないことを指定します。
- `-GCC` <br>
ファイルの内容を比較することで、ファイルのローカルコピーが現在のものかどうかを判断します。
- `-GCD` <br>
日付と時刻の比較を使用して、ファイルのローカルコピーが現在のものかどうかを判断することを指定します。
- `-GCK` <br>
ファイルのローカルコピーが現在のものかどうかを判断するためにチェックサムを使用することを指定します。
- `-GF` <br>
このコマンドのForce_Dir初期化変数を有効にします。
- `-GF-` <br>
このコマンドのForce_Dir初期化変数を無効にします。
- `-GL<パス>` <br>
カレントフォルダや作業フォルダではなく、指定したフォルダにファイルをコピーします。
- `-GN` <br>
テキストファイルの行末文字としての改行を指定します。
- `-GR` <br>
テキストファイルの行末文字としてキャリッジリターンを指定します。
- `-GRN` <br>
テキストファイルの行末文字として、キャリッジリターンとラインフィードのペアを指定します。
- `-GTC` <br>
作業コピーに現在の日時を与えることを指定します。
- `-GTM` <br>
現在の日時ではなく、ファイルが最後に変更された日時をローカルコピーに与えることを指定します。
- `-GTU` <br>
ローカルコピーには、現在の日時ではなく、ファイルが最後にチェックインされた日時が与えられることを指定します。
- `-GWA` <br>
取得およびチェックアウト操作で、書き込みのみのファイルを置換、スキップ、またはマージするかどうかを選択するためのダイアログボックスを表示します。
- `-GWM` <br>
特定の操作 (get と checkout) で書き込み専用のファイルをマージします。
- `-GWR` <br>
特定の操作 (get と checkout) で書き込み専用のファイルを置き換えます。
- `-GWS` <br>
特定の操作 (get と checkout) で書き込みのみのファイルをスキップします。


### `-I` (ファイル比較時に無視する設定)

VSSが2つのファイルを比較するときに無視すべき要因を示します。
このオプションを -C オプションと一緒に使用すると、コメントプロンプトを避けることができます。

- `-I` <br>
選択した比較要因を無視します。

- `-I-` <br>
すべてを無視し、いかなる状況下でも入力を求めないようにコマンドに指示します。

- `-I-Y` <br>
すべての質問に対して「はい」と答えます。

- `-I-N` <br>
すべての質問に対して「いいえ」と答えます。

- `-IC` <br>
大文字小文字を無視します。例えば、大文字のAは小文字のaと同じとみなされます。

- `-IE` <br>
行末の文字の違いを無視します。-IEはデフォルトです。

- `-IS` <br>
小さな変更を無視します。このオプションを使用すると、変更の大部分が実際にはマッチしていないのにマッチしているように見えてしまうことを防ぎます。

- `-IW` <br>
スペースやタブなどの空白を無視します。



### `-K` (チェックイン時)

ファイルをチェックインした後もチェックアウトしたままにするかどうかを指定します。

- `-K` <br>
ファイルをチェックアウトしておく。
- `-K-` <br>
ファイルをチェックアウトしていません。


### `-L` (チェックアウト・マージ時)

多くのコマンドのファイルまたはプロジェクトのラベルを指定します。checkoutコマンドでは、このオプションは、ローカルバージョンのチェックアウト機能を有効または無効にします。mergeコマンドでは、このオプションは、マージがローカルで、結果が作業フォルダにチェックアウトされたままになることを示します。

- `-L` <br>
ラベルを持つファイルまたはプロジェクトのバージョンを表示します。
  - checkoutコマンドでは、このオプションはローカルバージョンのチェックアウトを有効にします。
  ```
  ss Checkout $/file.txt -L
  ```
  - mergeコマンドでは、このオプションは、マージがローカルで、結果が作業フォルダにチェックアウトされたままになることを示します。
- `-L<名前>` <br>
指定されたラベルを持つファイルやプロジェクトのバージョンを表示します。
```
ss FindinFiles -L2.00b
```
- `-L-` <br>
Checkoutコマンドでは、ローカルバージョンのチェックアウトを無効にし、現在のデータベースバージョンのチェックアウトを許可します。
```
ss Checkout $/file.txt -L-
```

### `-M` (チェックアウト時)

指定したファイルの排他的チェックアウトを有効にします。

- `-M` <br>
排他的なチェックアウトを無効にします。
```
ss Checkout $/file.txt -M
```
- `-M-` <br>
個々のファイルの排他的なチェックアウトを可能にします。
```
ss Checkout $/file.txt -M-
```

### `-N` (ファイル名)

コマンドのファイル命名規則を指定します。

- `-N` <br>
初期化ファイルのLong_Filenames初期化変数の設定を使用します。デフォルトでは、このオプションは `-NL` と同じです。
- `-NL` <br>
長いファイル名モードを指定します。
- `-NS` <br>
短いファイル名モードを指定します。


### `-O` (出力)

大量の情報を表示する可能性のあるコマンドの出力を制御します。このオプションを指定しないと、情報が画面上で素早くスクロールして読み取れなくなります。

- `-O` <br>
すべての出力を提示します。
- `-O-` <br>
エラー出力のみを表示します。
- `-O@<ファイル名>`
すべての出力を指定したファイルに送信します。これは、履歴レポートなどのレポートをファイルまたはプリンタにエクスポートするためのコマンドライン方式です。指定されたファイルが既に存在する場合、出力はそのファイルに追加されます。
- `"-O&<ファイル名>"`
コマンド出力に加えて、標準エラー出力を指定したファイルに送信します。引用符「"」は、Windows NT プラットフォームでは必須であり、その他のプラットフォームではオプションです。指定されたファイルが既に存在する場合、出力はそのファイルに追加されます。
- `-O&-`
出力を提供しません。


### `-P` (プロジェクトの指定)

コマンドで使用するプロジェクトを指定します。

- `-P` <br>
現在のプロジェクトを指定します。
- `-P<プロジェクト名>` <br>
指定されたプロジェクトを指定します。



### `-Q` (出力の抑制)

コマンドラインコマンドの出力を抑制します。

- `-Q` <br>
  出力を抑制します。

### `-S` (スマートモード)

特定のコマンドのSmart_Mode初期化変数を上書きします。

- `-S` <br>
スマートモードを有効にします。
- `-S-` <br>
スマートモードを無効にします。


### `-U` (ユーザ情報の表示)

ファイルまたはプロジェクトに関するユーザー情報を表示します。

- `-U` <br>
ファイルまたはプロジェクトの現在のユーザーを指定します。
- `-U<名前>` <br>
指定されたユーザーを指定します。


### `-V` (バージョン)

ファイルまたはプロジェクト（アイテム）のバージョンを示します。

- `-V<番号>` <br>
表示されているバージョン番号でバージョンを指定します。
```
ss History -V14
ss History -V5~3
ss History -VHelp.c;6
```
- `-Vd<日付>` <br>
指定された日時のスタンプを持つバージョンを指定します。
```
ss History -Vd2-29-92
ss History $/test -Vd3/03/95;3:00p~3/03/95;9:00a
ss History -VShow.prg;d2-29-92
```
- `-Vl<ラベル>` <br>
表示ラベルを持つバージョンを指定します。
```
ss History -VlFinal Beta
```


### `-W` (読み取り専用/書き込み可能)

作業コピーを読み取り/書き込みまたは読み取り専用にするかどうかを示します。既定では、ファイルがチェックアウトされていない場合、VSSは作業コピーを読み取り専用にして、変更できないようにします。Ss.ini の Use_ReadOnly 初期化変数は、この既定の動作を変更します。

- `-W` <br>
読み取り/書き込みに作業コピーを設定します。
- `-W-` <br>
作業コピーを読み取り専用に設定します。


### `-Y` (ユーザ名)

ユーザー名またはユーザー名とパスワードを指定します。別のユーザーとしてコマンドを実行する場合は、このオプションを使用します。

- `-Y<ユーザー名>`
ユーザー名を指定します。
- `-Y<ユーザー名>,<パスワード>`
ユーザー名とパスワードを指定します。



<br>

### 参考文献

- [Command Options \| Microsoft Docs](https://docs.microsoft.com/en-us/previous-versions/hsxzf2az%28v=vs.80%29)
